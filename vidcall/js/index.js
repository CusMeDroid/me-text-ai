/* Powered By CusMeDroid */
$.getJSON("https://api.ipify.org?format=json",(function(e){console.log(e.ip),$("#myipaddr").html(e.ip)}));var lineK=document.getElementById("kontakmain"),lineC=document.getElementById("callmain");function callNow(){var e=document.getElementById("nameserver");if(e.value<1)alert("Jangan Kosong!");else{lineK.style.display="none",lineC.style.display="block";var n=firebase.database().ref(),t=(document.getElementById("yourVideo"),document.getElementById("friendsVideo")),s=Math.floor(1e9*Math.random()),o=e.value,a=document.getElementById("myipaddr").value;console.log("IP Address : "+a);console.log("Server : "+o),firebase.database().ref("MeTextAI/VidCall/"+o).set({id:s,ip:a,host:o});var i=new RTCPeerConnection({serName:[{urls:"stun:stun.services.mozilla.com"},{urls:"stun:stun.l.google.com:19302"},{urls:"turn:numb.viagenie.ca",credential:"cusmedroid",username:"cusmedroidteam@gmail.com"}]});function d(e,t){n.push({sender:e,message:t}).remove()}i.onicecandidate=e=>e.candidate?d(s,JSON.stringify({ice:e.candidate})):console.log("Sent All Ice \nID : "+s+"\nHOST : "+o),i.onaddstream=e=>t.srcObject=e.stream,n.on("child_added",(function(e){var n=JSON.parse(e.val().message);e.val().sender!=s&&(null!=n.ice?i.addIceCandidate(new RTCIceCandidate(n.ice)):"offer"==n.sdp.type?i.setRemoteDescription(new RTCSessionDescription(n.sdp)).then((()=>i.createAnswer())).then((e=>i.setLocalDescription(e))).then((()=>d(s,JSON.stringify({sdp:i.localDescription})))):"answer"==n.sdp.type&&i.setRemoteDescription(new RTCSessionDescription(n.sdp)))})),function showMyFace(){navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then((e=>yourVideo.srcObject=e)).then((e=>pc.addStream(e)))}function showFriendsFace(){pc.createOffer().then((e=>pc.setLocalDescription(e))).then((()=>sendMessage(yourId,JSON.stringify({sdp:pc.localDescription}))))}}}function closeKa(){location.href=""}
